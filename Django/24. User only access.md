views.py in blog app:
```Python
from django.shortcuts import render, get_object_or_404, redirect
from django.http.response import HttpResponseForbidden

# Create your views here.
from blog.models import Article, Comment
from blog.forms import CreateCommentForm


def blog_page(request):
    arts = Article.articles.filter(is_show=True)
    search_keyword = request.GET.get('search')

    if search_keyword:
        arts = arts.filter(title__icontains=search_keyword)

  
    context = {
        'articles': arts
    }
    return render(request, 'blog/blog_index.html', context)



def article_detail(request, article_id):
    article = get_object_or_404(Article, id=article_id)
    coms = Comment.objects.filter(is_show=True).filter(article_object_id=article_id)    
    if request.method == 'POST':
        form = CreateCommentForm(data=request.POST, files=request.FILES)
        if form.is_valid() and request.user.is_authenticated:
            comment_title = form.cleaned_data.get('title')
            comment_text = form.cleaned_data.get('text')
            comment_image = form.cleaned_data.get('image')
            comment_article = get_object_or_404(klass=Article, id=article_id)
            comment_user = request.user
            Comment.objects.create(title=comment_title, text=comment_text, is_show=False, article_object=comment_article, user_object=comment_user, image=comment_image)
            return redirect('blog:success_comment_name')
        else:
            if not request.user.is_authenticated:
                # form.add_error('', 'You must login first!')
                return HttpResponseForbidden('You must log in first!')
    else:
        form = CreateCommentForm()
    context = {
        'article': article,
        'form': form,
        'coms': coms
    }
    return render(request, 'blog/detail_index.html', context)


def success_comment(request):
    return render(request, 'blog/success_index.html')
```

forms.py in blog app:
```Python
from django import forms

class CreateCommentForm(forms.Form):
    title = forms.CharField(max_length=110)
    text = forms.CharField(max_length=550, widget=forms.Textarea)
    image = forms.ImageField(required=False)
```

models.py in blog app:
```Python
from django.db import models
from django.contrib.auth.models import User
# Create your models here.


class Article(models.Model):
    title = models.CharField(max_length=110)
    image = models.ImageField(blank=True, null=True, upload_to='blog_images', height_field=None, width_field=None, max_length=None)
    text = models.TextField(help_text='Enter your text')
    is_show = models.BooleanField(default=False
    created_date = models.DateTimeField(auto_now_add=True)
    update_date = models.DateTimeField(auto_now=True)
    author = models.ForeignKey(User, on_delete=models.DO_NOTHING)
    articles = models.Manager()

    def __str__(self):
        return self.title  
 

class Comment(models.Model):
    title = models.CharField(max_length=110)
    text = models.TextField()
    image = models.ImageField(upload_to='blog_comment', height_field=None, width_field=None, max_length=None, null=True, blank=True)
    is_show = models.BooleanField(default=False)
    article_object = models.ForeignKey('Article', on_delete=models.CASCADE)
    user_object = models.ForeignKey(User, on_delete=models.DO_NOTHING)
    created_date = models.DateTimeField(auto_now_add=True)
    update_date = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.title + ' - ' + self.article_object.title
```

urls.py in blog app:
```Python
from django.urls import path
from . import views


app_name = 'blog'
urlpatterns = [
    path('blog/', views.blog_page, name='blog_page_name'),
    path('blog/detail/<int:article_id>/', views.article_detail, name='article_detail_name'),
    path('blog/detail/successfully-send', views.success_comment, name='success_comment_name')
]
```

admin.py in blog app:
```Python
from django.contrib import admin

# Register your models here.
from . import models


admin.site.register(models.Article)

@admin.register(models.Comment)
class CommentAdmin(admin.ModelAdmin):
    readonly_fields = ['user_object', 'article_object', 'image']
```

apps.py in blog app:
```Python
from django.apps import AppConfig


class BlogConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'blog'
```


# Login required

views.py in accounts app:
```Python
from django.shortcuts import render, redirect
from . import forms as cfs
from django.contrib.auth import authenticate, login, logout
from django.contrib.auth.models import User
from django.contrib.auth.decorators import login_required


def login_page(request):
    if request.user.is_authenticated:
        return redirect('accounts:dashboard_page_name')
    login_form = cfs.UserLoginForm()
    if request.method == 'POST':
        login_form = cfs.UserLoginForm(data=request.POST)
        if login_form.is_valid():
            username_input = login_form.cleaned_data.get('username')
            password_input = login_form.cleaned_data.get('password')
            user = authenticate(request, username=username_input, password=password_input)

            if user is not None:
                login(request, user)
                return redirect('accounts:dashboard_page_name')
            else:
                login_form.add_error('password', 'Invalid username or password!')
    context = {
        'login_form': login_form
    }
    return render(request, 'accounts/login_index.html', context)


# important part for redirecting user to login page
@login_required(login_url='/login/')
def dashboard_page(request):
    context = {
        'username': request.user
    }
    return render(request, 'accounts/dashboard_index.html', context)


def log_out(request):
    logout(request)
    return redirect('home:home_page_name')


def register_page(request):
    if request.user.is_authenticated:
        return redirect('accounts:dashboard_page_name')
    register_form = cfs.UserRegisterForm()
    if request.method == 'POST':
        register_form = cfs.UserRegisterForm(data=request.POST)
        if register_form.is_valid():
            first_name = register_form.cleaned_data.get('first_name')
            last_name = register_form.cleaned_data.get('last_name')
            username = register_form.cleaned_data.get('username')
            confirm_password = register_form.cleaned_data.get('confirm_password')
            email = register_form.cleaned_data.get('email')
            user = User.objects.create_user(username=username, password=confirm_password)
            user.first_name = first_name
            user.last_name = last_name
            user.email = email
            user.save()
            return redirect('accounts:login_page_name')
    context = {
        'register_form': register_form
    }
    return render(request, 'accounts/register_index.html', context)
```
The login_required decorator is used to force the user to log in to the website.

urls.py in accounts app:
```Python
from django.urls import path
from . import views


app_name = 'accounts'
urlpatterns = [
    path('login/', views.login_page, name='login_page_name'),
    path('dashboard/', views.dashboard_page, name='dashboard_page_name'),
    path('log-out/', views.log_out, name='logout_page_name'),
    path('register/', views.register_page, name='register_page_name')
]
```

Create a variable `LOGIN_URL = '/login-url/'` in `settings.py`. Then you don't need to send login-url to decorators.

settings.py:
```Python
# After many line of codes
LOGIN_URL = '/login/'
```

viewes.py in accounts app:
```Python
@login_required
def dashboard_page(request):
    context = {
        'username': request.user
    }
    return render(request, 'accounts/dashboard_index.html', context)

```

# Access for specific user
To display buttons to a specific user in HTML, use their ID:
```Django
{% if request.user.is_authenticated %}
  {% if article.author.id == request.user.id %}
	  <a href="{% url 'blog:article_edit' article.id %}" class="btn btn-primary my-2">Edit</a>
	   <a href="{% url 'blog:article_delete' article.id %}" class="btn btn-danger my-2">Delete</a>
  {% endif %}
{% endif %}
```
