# Code archive
> [!NOTE] Path: `blog\views.py`
```Python
from django.shortcuts import render, get_object_or_404, redirect
from django.http.response import HttpResponseForbidden
from django.core.paginator import Paginator
from blog.models import *


def get_articles_by_category(request, category_id):
    # category_title = get_object_or_404(Category, id=category_id).title
    # articles = Article.articles.filter(categories__id=category_id).filter(is_show=True)
  
    category = get_object_or_404(Category, id=category_id)
    articles = category.article_set.filter(is_show=True)

    pag = Paginator(articles, 2)
    page_number = request.GET.get('page')
    page_object = pag.get_page(page_number)
    context = {
        'page_object': page_object,
        'category_title': category.title
    }
    return render(request, 'blog/blog_index.html', context)
```

> [!NOTE] Path: `blog\urls.py`
```Python
from django.urls import path
from . import views


app_name = 'blog'
urlpatterns = [
    path('blog/', views.blog_page, name='blog_page_name'),
    path('blog/detail/<int:article_id>/', views.article_detail, name='article_detail_name'),
    path('blog/detail/successfully-send/', views.success_comment, name='success_comment_name'),
    path('blog/<int:category_id>/', views.get_articles_by_category, name='get_arts_by_cat_name')
]
```

> [!NOTE] Path: `blog\models.py`
```Python
from django.db import models
from django.contrib.auth.models import User


class Article(models.Model):
    title = models.CharField(max_length=110, verbose_name='عنوان')
    image = models.ImageField(blank=True, null=True, upload_to='blog_images', height_field=None, width_field=None, max_length=None, verbose_name='تصویر')
    text = models.TextField(help_text='Enter your text', verbose_name='متن')
    is_show = models.BooleanField(default=False, verbose_name='نمایش')
    created_date = models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')
    update_date = models.DateTimeField(auto_now=True, verbose_name='آخرین بروزرسانی')
    author = models.ForeignKey(User, on_delete=models.DO_NOTHING, verbose_name='نویسنده')
    categories = models.ManyToManyField('Category', verbose_name='دسته‌ها')
    articles = models.Manager()
  
    class Meta:
        ordering = ['update_date']
        db_table = 'Articles'
        verbose_name = 'مقاله'
        verbose_name_plural = 'مقالات'

    def __str__(self):
        return self.title


class Category(models.Model):
    title = models.CharField(max_length=50)

    def __str__(self):
        return self.title
```

> [!NOTE] Path: `blog\templates\blog\blog_index.html`
```Django
{% load static %}
<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Blog page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="{% static 'blog/blog_style.css' %}">
    </head>
    <body>
        <form action="" method="get" id="form-s">
                <input id="sear" type="text" placeholder="Search..." name="search">
                <button id="b-sear" type="submit"> Search </button>
        </form>

        {% if categories %}
            <h1>Categories</h1>
            <ul>
            {% for category in categories %}
                <a href="{% url 'blog:get_arts_by_cat_name' category.id %}"><li>{{ category.title }}</li></a>
            {% endfor %}
            </ul>
        {% elif category_title %}
            <h1>{{ category_title }}</h1>
        {% endif %}

        <br><hr>
        <h1>Articles list</h1>
        <br>
        {% comment %} 
        <div class="all-articles">
        {% for article in articles %}
            <a href="{% url 'blog:article_detail_name' article.id %}" class="artlink">
                <div class="article-div">
                    {% if article.image %}
                        <img class="art-img" src="{{article.image.url}}" alt="article.title">
                    {% endif %}
                    <h3>{{article.title|title}}</h3>
                    <p class="art-text">{{article.text|truncatewords:10|capfirst}}</p>
                    <p class="art-date">{{article.created_date|date:"o/m/d"}}</p>
                </div>
            </a>
        {% empty %}
            <p>List is empity!</p>
        {% endfor %} 
        {% endcomment %}

        <div class="all-articles">
        {% for article in page_object.object_list %}
            <a href="{% url 'blog:article_detail_name' article.id %}" class="artlink">
                <div class="article-div">
                    {% if article.image %}
                        <img class="art-img" src="{{article.image.url}}" alt="article.title">
                    {% endif %}
                    <h3>{{article.title|title}}</h3>
                    <p class="art-text">{{article.text|truncatewords:10|capfirst}}</p>
                    <p class="art-date">{{article.created_date|date:"o/m/d"}}</p>
                </div>
            </a>
        {% empty %}
            <p>List is empity!</p>
        {% endfor %}
        </div>
  
        <div class="pagination">
            <span class="step-links">
                {% if page_object.has_previous %}
                    <a href="?page=1">&laquo; first</a><span> | </span>
                    <a href="?page={{ page_object.previous_page_number }}">previous</a>
                {% endif %}
                <span class="current">| Page {{ page_object.number }} of {{ page_object.paginator.num_pages }} |</span>
                {% if page_object.has_next %}
                    <a href="?page={{ page_object.next_page_number }}">next</a><span> | </span>
                    <a href="?page={{ page_object.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
            </span>
        </div>

    </body>
</html>
```

> [!NOTE] Path: `blog\admin.py`
```Python
from django.contrib import admin
from django.contrib import messages
from . import models


# @admin.action(description='به نمایش در آوردن مقالات')
# def make_article_public(modeladmin, request, queryset):
#     updeted = queryset.update(is_show=True)
#     modeladmin.message_user(request, f'{updeted} عدد مقاله به نمایش در آمد.', messages.SUCCESS)


# @admin.register(models.Article)
class ArticleAdmin(admin.ModelAdmin):
    list_display = ['title', 'author', 'created_date', 'update_date', 'is_show']
    search_fields = ['title', 'text']
    list_editable = ['is_show']
    list_filter = ['is_show', 'author']
    date_hierarchy = 'created_date'
    # ordering = ['-id']
    fieldsets = [
        (
            None,
            {
                'fields': ['title', 'text', 'image', 'categories', 'is_show'],
            },
        ),
        (
            'Advanced options',
            {
                'classes': ['collapse'],
                'fields': ['author'],
            },
        ),
    ]
  
    @admin.action(description='به نمایش در آوردن مقالات')
    def make_article_public(self, request, queryset):
        updeted = queryset.update(is_show=True)
        self.message_user(request, f'{updeted} عدد مقاله به نمایش در آمد.', messages.SUCCESS)
    actions = [make_article_public]
admin.site.register(models.Article, ArticleAdmin)


# admin.site.register(models.Comment)


@admin.register(models.Comment)
class CommentAdmin(admin.ModelAdmin):
    readonly_fields = ['user_object', 'article_object', 'image']


admin.site.register(models.Category)
```
